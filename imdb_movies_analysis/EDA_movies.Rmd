
---
title: "Exploring IMDB Movies Dataset"
author: Iulia Khomenko
date: 10.17.2017
output: 
  html_document:
    toc: true
    toc_depth: 3
    toc_float: true
---

```{r global_options, include=FALSE}
knitr::opts_chunk$set(echo=FALSE)
```


```{r echo=FALSE, echo=TRUE, message=FALSE, warning=FALSE}
library(ggplot2)
library(dplyr)
library(purrr)
library(gridExtra)
library(scales)
library(tidyr)
library(GGally)
library(reshape2)
library(memisc)
library(RColorBrewer)
```

Let's load the dataset and have a look on the data.

```{r, message=TRUE, warning=TRUE}
movies <- read.csv('movie_metadata.csv')
```

### Dataset introduction

This data was scraped from IMDB website and published on 
[Kaggle](https://www.kaggle.com/deepmatrix/imdb-5000-movie-dataset) by user 
chuansun76 about a year ago. 

It contains information (both basic info provided by IMDB and complimentary data
from other sources) about some 5000 movies directed in the last 100 years in 66 
countries of the world. Each observation (movie) is described by 28 variables 
such as director name, movie genre, budget etc.

Let's check out the dimensions of the dataset:
```{r}
dim(movies)
```
The dataset has 5043 observation across 28 variables. 

Let's have a closer look on our variables

```{r, echo=FALSE, message=FALSE, warning=FALSE}
str(movies)
```

We have 12 factor and 16 numeric variables. All variable types look appropriate
and do not require changes.

All variables could be divided in three groups: movie production characteristics
(title year, duration, genre), popularity  characteristics (number of voted 
users, number of user reviews, movie facebook likes) and financial 
chracteristics (budget and gross).

Now perform basic sanity check of the data

```{r}
summary(movies)
```

For categorical variables basic sanity check revealed many NAs and blank cells.
I suspect we also have some duplicate string, according to the summary of our 
movie_title variable. Also the variables in genre column contain several values
in one cell. We would need to split those values in order to be able to analyse 
the data. 

As for numeric variables, my main concern is budget column with 
maximum value of 12 bln! We would need to double check currencies of the budget 
and gross values for all the movies. 

Another potential problem with financial variables is:
IMDb site shows the budget and gross numbers announced at the year of movie 
release. Here we need to be careful as USD100 in 2005 are not the same money as 
USD100 in 2016 due to inflation and other factors. So we would need to 
standardize both gross and budget columns to the same base, in case we want to 
include them in our analysis. 

Now we build coorelation matrix and visualize to check the correlation 
coefficients with numeric variables and decide which variables we will 
investigate in our analysis. 

```{r}
#building and plotting correlation matrix
nums <- sapply(movies, is.numeric)
cormat <- round(cor(movies[ , nums], use = "na.or.complete"),2)
 melted_cormat <- melt(cormat)
 
ggplot(aes(x = Var1, y= Var2, fill = value), data = melted_cormat) + 
  geom_tile()+
  geom_text(aes(label = value), size = 3) + 
  theme(axis.text.x=element_text(angle=45,hjust=1))+
  scale_fill_gradient(low = "yellow", high = "red")
```

There is a considerable positive correlation between IMDb score and movie 
duration, number of voted users, there is also noticable negative
correlation between imdb score and title year. We will consider those variables 
in our analysis. 

# Posing question and defining features of interest 

In this analysis we will investigate factors that contribute to movies IMDB 
score. 

There are several main features of interest that we selected for our analysis
based on correlation coefficients and intuition :)

Numerical features:

- title_year

- duration

- number of users voted

- num_user_for_review

- num_critic_for_review

- movie_facebook_likes

- budget

- gross

Categorical features: 

- genre

### Dataset Preparation and Cleaning

As noted above, we need to standardize variables 'gross' and 'budget' to account 
for inflation rate across years to be able to compare and analyse those 
variables, we also need to convert all currencies to USD, since for
many movies shot outside the US, movie budget is indicated in local
currency (the enormous figure of 12 bln budget reveal by sanity check, is shown 
in Korean wons, which is some 10 mln dollars). 

By looking at the [source code for the dataset webscraping part](https://github.com/sundeepblue/movie_rating_prediction/blob/master/movie/spiders/imdb_spider.py) 
we can see that the budget and gross data were scraped with currency description,
so most likely the currency description was dropped while parsing the scraped 
data. 

We made some minor adjustments to the [dataset parsing source code](https://github.com/sundeepblue/movie_rating_prediction/blob/master/parse_scraped_data.py) 
to serve our purpose and created new column for currency, we also converted all 
currency signs (e.g. '$', '€' ETC) to abbreviations ('USD', 'EUR' etc). 

```{r}
#reloading updated dataset
movies = read.csv('movie_metadata2.csv', na.strings = c('','NA',"None"))
```


```{r}
#let's also remove NAs
movies <- na.omit(movies)

#remove duplicate rows based on any duplicated values in 'movie_title',
#director_name' and 'genres' columns
movies <- distinct (movies, movie_title, director_name, genres,
                    .keep_all = TRUE)
movies$budget_currency <- factor(movies$budget_currency)
```

After we did some cleaning on our updated dataset, let's get right to 
standardizing financial varaibles so first we summarise our data by currency and
title year

```{r}
movies_currency_year <- subset(movies, movies$budget_currency != 'USD') %>%
  group_by(budget_currency, title_year) %>%
  summarize (n = n())

head(movies_currency_year, 10 )
```

Now we convert all budget values to USD, then standardize our values to 2016 
base, accounting for inflation across years.

So we need to add exchange rate for each currency in the given year, we do
that scraping information from this 
[superhelpful website](http://fxtop.com/en/historical-exchange-rates.php?MA=1). 
and writing our scraped data frame into separate csv file so we don't have
to do scraping every time we run the code. The web scraping parts was performed
in R and the scrip could be found in `exrates_scraping_script.Rmd` file.

Then we create a column in our original movies dataframe with the exchange 
rate and then convert movies budget to USD.  

```{r, message=FALSE, warning=FALSE}
#reload the exchange rate data from csv file
exrates_df <- read.csv('ExRates2.csv', row.names = c(1))

#first convert variables to numeric
exrates_df$year <- as.numeric(as.character(exrates_df$year))
exrates_df$rate <- as.numeric(as.character(exrates_df$rate))

movies <- left_join(movies, exrates_df, by = c('budget_currency' = 'currency',
                                               'title_year' = 'year'))
```

Let's examine our data now. We inserted exchange rates for all currencies but 
USD, so let's see if all foreign currencies were provided with exchange rates 
now.

```{r}
foreign_movies <- subset(movies, movies$budget_currency != 'USD')
subset(foreign_movies[,c('director_name','movie_title','budget_currency',
                         'title_year')], is.na(foreign_movies$rate))
```

We have one row without exchange rate, this is because the exchage rate from 
1927 was not covered in our scraped data. We will insert the rate for this row
manually, using historical records from
[this site](http://www.history.ucsb.edu/faculty/marcuse/projects/currency.htm)

```{r}
movies$rate[movies$director_name == 'Fritz Lang']<-1/4.21
```

For now we also set the exchange rate for USD as 1. 

```{r}
movies$rate[movies$budget_currency == 'USD'] <- 1
```

To convert budget values to USD we use the provided exchange rate for each 
currency, then we would need to standardize all budget and gross values 
accounting for inflation rate.

To convert the budgets to 2016 year base, we use Consumer Price Index (CPI):
Past dollars in terms of recent dollars = Dollar amount × Ending-period CPI ÷ 
Beginning-period CPI.

The US CPI for the period 1900 - 2016 was downloaded as csv file from 
[here](https://www.measuringworth.com/uscpi/result.php)

Ending period CPI is 2016 and is equal to 240.01, while the beginning period CPI
for each budget value we indicate in our dataset by creating new column `cpi`.

```{r}
#converting budget for all movies to USD
movies$budget_usd <- movies$budget * movies$rate

#standardizing budget amount to 2016 base using consumer price index (CPI)
cpi <- read.csv('US_CPI_1900-2016.csv', row.names = NULL, skip = 4)
column_names <- c('year','cpi')
colnames(cpi) <- column_names
movies <- left_join(movies, cpi, by = c('title_year' = 'year'))
movies$budget_2016 <- movies$budget_usd*240.01 /movies$cpi

#we also need to standardize gross column of the dataframe
movies$gross_2016 <- movies$gross*240.01 / movies$cpi
```

We also need to tidy `genres` column as it contains several values in one cell, 
so we need to  split the values to be able to analyse this data. For that we
create new dataframe, split genres values and create new rows for each genre 
value.

```{r}
genres_df <- movies %>%
  mutate(genres = strsplit(as.character(genres), '|', fixed = TRUE)) %>%
  unnest(genres)
```


Now looks like we cleaned and prepared the data and now we are ready to dive 
into analysis

# Univariate Plots Section

Firstly, let's have a closer look on summary and distribution of our key 
variable:

```{r}
summary(movies$imdb_score)
```


```{r, message=FALSE, warning=FALSE}
#function, that takes histogram variable and number of bins as input and outputs
#basic histogram plot

create_histo <- function(varname, data, bins = 30){
  return(ggplot(aes_string(x = varname), data = data) 
         + geom_histogram(bins = bins))
}

create_histo('imdb_score', movies, 40) +
  scale_x_continuous(breaks = seq(1,10,.5)) + 
  geom_vline(aes(xintercept = mean(imdb_score), color = 'Mean'),linetype = 2)+ 
  geom_vline(aes(xintercept = median(imdb_score), color = 'Median'),
             linetype = 3)+
  scale_colour_manual(values = c("red","yellow"), name = " ")
```

The distribution is a bit skewed to the left but otherwise looks like normal 
distribution, with most data points are witin 6.0 and 7.5 interval with minimum 
value at 1.5, maximum value at 9.3, mean and median at the center of the
distribution.

Let's have a look on movies distribution by title_year

```{r}
table(movies$title_year)
```

Let's consolidate datapoints by cutting title_year variable in decades 
using R function cut and then plot the result

```{r echo=FALSE, Univariate_Plots}

break_points = c(1920,1930,1940,1950,1960,1970,1980,1990,2000,2010,2017)
movies$title_year.bucket <- cut(movies$title_year, breaks = break_points, 
                                labels = c("1920s", "1930s", "1940s", "1950s", 
                                           "1960s", "1970s", "1980s", "1990s",
                                           "2000s", "2010s") )

ggplot(aes(x = title_year.bucket), data = movies) + 
  geom_bar()
```

The major part of the movies presented in the dataset were directed between 
1990s  and 2010s, with the peak at 2000s decade, whereas the old movies are not 
represented that well in the dataset. 

Let's explore our genres now. We use our genres_df dataframe in order to 
visualize the distribution of movies by genres. 

```{r}
ggplot(aes(x = genres), data = genres_df) + 
  geom_bar() +
  stat_count(aes(label=..count..), vjust=-.5, 
             geom="text", position="identity") + 
  theme(axis.text.x=element_text(angle=45,hjust=1))
```

The top-5 genres of the movies in our dataset are : Drama, Comedy, Thriller, 
Action and Romance.

The top-5 least represented movie genres are: Film Noir, Documentary, Western,
Musical, Sport.

Now let's explore closer movie budgets. In order to draw appropriate conclusions
we consider standardized variables. 

Let's check out summary first 

```{r}
summary(movies$budget_2016)
```

Our values are quite skewed (minimum budget is some USD284.-, while the values 
of 75% of the data varies from USD13.38 mln to USD66.71 mln and the maximum 
budget was enormous USD347.3 mln),therefore we would need to trasnform our data 
to see the values distribution more clearly. We do that using log10 
trasnformation. For comparison sake, we put non-transformed and trasnformed data
together. 

```{r, message=FALSE, warning=FALSE}
budget_median <- median(movies$budget_2016)

p1<-create_histo('budget_2016', movies, 60)

p2 <- create_histo('budget_2016', movies, 60)+
  geom_vline(aes(xintercept = budget_median), color = 'red', linetype = 2)+
  geom_vline(aes(xintercept = median(budget_2016), color = 'Median'), 
             linetype = 2, show_guide = TRUE) + 
  geom_vline(aes(xintercept = quantile(movies$budget_2016, .75),
                 color = 'Quantile 3'), linetype = 3)+
  geom_vline(aes(xintercept = quantile(movies$budget_2016, .25), 
                 color = 'Quantile 1'), linetype = 3)+
  scale_colour_manual(values = c("red","blue", 'yellow'), name = " ")+
  scale_x_log10() +
  labs(x = 'log10(budget_2016)')


grid.arrange(p1,p2, ncol = 1)
```

The transformed data is a bit skewed to the left. Movie budgets look to be
quite diverse ranging between tens of million dollars to hundreds of million
dollars.

Let's compare the average imdb score for top-5 highest budget and top 5 lowest 
budget movies

```{r}
#moving top 5 movies to separate dataframes for easy processing
top_high_budget <- head(movies[order(movies$budget_2016,decreasing = TRUE),])
top_low_budget <- head(movies[order(movies$budget_2016),])
```

```{r, echo=FALSE}
print (sprintf('Overall mean IMDB score: %.2f',mean(movies$imdb_score)))
print (sprintf("Mean IMDB score for higherst budget movies: %.2f",
               mean(top_high_budget$imdb_score)))
print (sprintf("Mean IMDB score for lowest budget movies: %.2f", 
               mean(top_low_budget$imdb_score)))
```


Since the distribution of our IMDb scores is almost normal, let's use the 
benefits of Central Limit Theorem to estimate how far from each other are the 
above mean scores. We calculate the standard diviation first:

```{r, echo=FALSE}
(mean(top_high_budget$imdb_score)
 -mean(top_low_budget$imdb_score))/sd(movies$imdb_score)
```

This is curious how close are average scores for highest budget and lowest 
movies. They are less than .12 standard deviation apart ! 
It is also curious that the lowest budget movies have imdb score higher then 
average.

Looks like the budget size and imdb_score are not related to each other, which 
goes quite against my inuition : I would definitely favour high budget movies
over low budget one for better graphics, soundtrack, cast etc. So we would need
to look into budget variable in tandem with other variables while performing
bivariate analysis. 

Now let's explore movies gross distribution

```{r, message=FALSE, warning=FALSE}
p1 <- create_histo('gross_2016', movies, 70) 
p2 <- create_histo('gross_2016', movies, 70) + 
  geom_vline(aes(xintercept = median(gross_2016), color = 'Median'), 
             linetype = 2, show_guide = TRUE) + 
  geom_vline(aes(xintercept = quantile(movies$gross_2016, .75),
                 color = 'Quantile 3'), linetype = 3)+
  geom_vline(aes(xintercept = quantile(movies$gross_2016, .25), 
                 color = 'Quantile 1'), linetype = 3)+
  scale_colour_manual(values = c("red","blue", 'yellow'), name = " ")+
  scale_x_log10() +
  labs(x = 'log10(gross_2016)')

grid.arrange(p1,p2,ncol = 1)
```

Since the distribution of the gross variable is quite skewed to the right, we 
performed logariphmic transformation to visualize the data. The transformed
distribution just like budget is slightly skewed to the left but otherwise 
looks normal.

Nevertheless, we need to remember that gross values indicated in this dataset 
are box office revenues earned in the US only and certainly a lot of movies with
low gross in US might have grossed much more in their country of origin (E.g. 
South Korean ["The Host"](http://www.imdb.com/title/tt0468492/) grossed only 
USD314,488 in the US, while in South Korea the movie box office was 
KRW 10,002,411,650, which is USD 8,748,609). 

To elaborate on movies profitability, we can also calculate movies profit and
then visualize profit distribution for all movies. 

```{r, echo=FALSE}
movies$profit <- movies$gross_2016 - movies$budget_2016
```

```{r, message=TRUE, warning=FALSE}
create_histo('profit',movies, 100) + 
  xlim(min(movies$profit), quantile(movies$profit, .95)) + 
  geom_vline(aes(xintercept = mean(profit), color = 'Mean'),  linetype = 2, 
             show_guide = TRUE) + 
  geom_vline(aes(xintercept = median(profit), color = 'Median'),linetype = 3, 
             show_guide = TRUE)+
  scale_colour_manual(values = c("red","yellow"), name = " ")
```

This is amazing how many movies have profit just above zero. 
Looks like the big part of the movies are making profits just to cover their 
budget expences.

However just as we observed above, gross numbers are indicated for the US only, 
let's consider only US movies for our profitability analysis 

```{r, warning=FALSE}
create_histo('profit', subset(movies, movies$country == 'USA'), 100) + 
  xlim(min(movies$profit), quantile(movies$profit, .95)) + 
  geom_vline(aes(xintercept = mean(profit), color = 'Mean'),  linetype = 2, 
             show_guide = TRUE) + 
  geom_vline(aes(xintercept = median(profit), color = 'Median'),linetype = 3, 
             show_guide = TRUE)+
  scale_colour_manual(values = c("red","yellow"), name = " ")
```

As we can see the general trend for profitability hasn't changed drammatically. 
The center of the distribution is very close to 0, which means almost half of 
American movies in this dataset grossed just enough to cover their budget 
expenses.

Now let's convert profit absolute numbers into a ratio and calculate 
return-on-invetsment (ROI) percentage for each movie (the gain/loss generated on
an investment relative to the amount of money invested)

We use the following formula: 
roi = profit / budget *100

```{r}
movies$roi <- round(movies$profit / movies$budget_2016 *100, 2)
summary(movies$roi)
```

The maximum ROI value of 719 300% looks quite suspicious, let's investigate it

```{r}
movies[movies$roi == max(movies$roi), c('movie_title','budget_2016', 
                                        'gross_2016')]
```

Ok, "Paranormal Activity" is an ultra low-budget horror movie, that made an 
enourmous box office when it went on the screen, it was also acknowledged as
[the most profitable movie of all time](https://www.thewrap.com/paranormal-now-most-profitable-film-ever-9335/)

But let's exclude such anomalies from our analysis and analyse the majority of 
the data.

```{r}
summary(subset(movies$roi, movies$roi < 1000))
```

```{r, message=FALSE, warning=FALSE}
ggplot(aes(x = roi), data = subset(movies, movies$roi < 1000)) + 
  geom_freqpoly(bins = 100) +
  scale_x_continuous(breaks = seq(min(movies$roi),1000,100)) + 
  geom_vline(aes(xintercept = median(roi)), color = 'blue', linetype = 2)
```

We see a curious spike just around -100, which basically means that having 
invested some budget the movie generated profit close to 0. The distribution is 
heavily skewed to the right and the typical value (median) of ROI percetage is 
justabout 5%.

Now let's explore the duration of the movies: we calculate summary and plot the
distribution first.

```{r}
summary(movies$duration)
```


```{r}
ggplot(aes(x = duration), data = movies) + 
  geom_freqpoly(bins = 100) +
  scale_x_continuous(breaks = seq(0,350,25))
```

The distribution peaks at about 100, which makes sense since the majority of 
movies are all about 1 hour and a half. 
However there are some short movies, with duration of 30 mins and below as well 
as 5 hours - long movies. 

Now look into the number of voted users variable:

```{r}
summary(movies$num_voted_users)
```

```{r}
create_histo('num_voted_users', movies, 60)
```

The distribution is heavily skewed to the right, so we make logariphmic 
transformation to see it more clearly. 

```{r}
create_histo('num_voted_users', movies, 60)+
  scale_x_log10(breaks = c(100, 1000, 10000, 100000, 1000000, 10000000)) + 
  geom_vline(aes(xintercept = mean(num_voted_users), color = 'Mean'), 
             linetype = 2) + 
  geom_vline(aes(xintercept = quantile(movies$num_voted_users, .75),
                 color = 'Quantile 3'), linetype = 3)+
  geom_vline(aes(xintercept = quantile(movies$num_voted_users, .25), 
                 color = 'Quantile 1'), linetype = 3)+
  scale_colour_manual(values = c("red","blue", 'yellow'), name = " ")
```

The transformed data is distrbuted almost normally, with the number of voted 
users peak at about 175 000 and the biggest part of the data is 
concentrated in range 120 000 and 1 100 000.

The last two variables we included in our analysis are: the number of users who
made movie review on IMDb web-site (num_user_for_review) and the number of 
reviews for the movies made on external web-sites. For the purpose of this 
analysis it will make more sense to explore these two variables in tandem
and therefore we sum them up into a new variable: total_movie_reviews.

```{r}
movies$movie_total_reviews <- movies$num_user_for_reviews + 
  movies$num_critic_for_reviews
```

```{r, warning=FALSE}
ggplot(aes(x = movie_total_reviews ), data= movies) + 
  geom_freqpoly(bins = 60)+
  xlim(0, quantile(movies$movie_total_reviews, 0.95))
```

The data distribution has tail to the right, and peaks at about 250 reviews.
The biggest part of the movies have 100 - 400 reviews in total, however there 
are still some movies with more than 1000 reviews.

Do the movies with big number of votes have also big number of user reviews?

Now we explore summary and distribution of movie facebook likes

```{r}
create_histo('movie_facebook_likes', 
             subset(movies, movies$movie_facebook_likes!=0 & 
                      movies$movie_facebook_likes < 50000), 60) +
  scale_x_continuous(breaks = seq(0,50000,2000))+
  theme(axis.text.x=element_text(angle=45,hjust=1))
```

Our data is skewed, it also has some curious gaps at regular intervals, I 
suspect facebook likes data in our dataset is incomplete and the values are not 
missing at random: there might be some bugs in data collection code.  

The number of facebook likes for the majority of movies is below 1000, however 
for some movies the number of likes rises up to 50 000.

# Univariate Analysis

### What is the structure of your dataset?

The original dataset contains 28 variables and 5043 observations. For the 
purpose of this analysis the number of observations was reduced by removing 
duplicate rows and NAs, we also created some new supporting variables, so the
final dataset has 3655 observations across 38 variables.

### What is/are the main feature(s) of interest in your dataset?

The main feature of interest is IMDb score: we aim to define the variables that
contribute to movie IMDb score.

### What other features in the dataset do you think will help support your \
investigation into your feature(s) of interest?

The features that support our exploration of IMDb score could be divided into
three main groups : 

- movie profitability characteristcs (gross, profit and ROI);

- movie popularity characteristics (number of voted users, movie total reviews);

- movie production characteristics (duration, genre and title year).

### Did you create any new variables from existing variables in the dataset?

To measure profitability of the movies, we created two new variables: profit 
(revenue earned by a certain movie in the US, expressed in an absolute number) 
and ROI (revenue generated by a certain amount of investment, exressed in 
percentage).

We also created several complimentary variables while converting movies budgets
to USD and than standardizing the numbers accounting for inflation rate over 
the years. This allowed us to analyse and compare budgets and gross numbers of 
the movies from different countries, directed at different times. 

On the top of that we summarized two movie popularity variables 
number of movie reviews on IMDb website and number of reviews on other websites 
and created one variable of total reviews for a movie. 
of the movie. 

We also consolidated movie title years by cutting them in decades and creating
new variable title_year.bucket for it.

### Of the features you investigated, were there any unusual distributions? \
Did you perform any operations on the data to tidy, adjust, or change the form \
of the data? If so, why did you do this?

We started off, by tidying our financial variables.

We also made some adjustments to our genres variable, by unwinding them into a 
separate dataframe. 

The biggest surprise so far was that profit levels for the movies, which were 
surprisingly low: almost half of the movies had profit levels below 0. Even 
after excluding foreign movies from profitability analysis (since the profit
number indicate movie revenues only in the US, we assumed that many movies with 
low profits in the US might have much better profit in their country of origin), 
the median profit value was close to 0 and median ROI percentage only 5%.

We also found an interesting pattern in movie_facebook_likes variable 
distribution: the data points on histogram are missing at regular intervals, 
which led us to assumption that this data might be incomplete with datapoints
are not missing at random which might be caused by some mistakes during data
collection process. 

# Bivariate Plots Section

Let's plot the key variables using the ggpairs function. We also include our
new varibles: ROI, profit and movie total reviews. 

```{r}
#select the key variables we would like to explore, we exclude categorical 
#varaibles since they are not supported by ggpairs. 
key_vars <- c('imdb_score', 'duration', 'gross_2016', 'budget_2016', 
              'num_voted_users', 'movie_total_reviews', 'roi', 'profit')
ggpairs(movies[,key_vars])
```

As per the correlation matrix, IMDb score has the highest correlation 
coefficients with number of voted users and the total number of movie reviews. 
There is also some considerable corelation between IMDb score and duration of 
the movies and movies gross

Let's consider these pairs one at a time

#### IMDb score vs. Number of voted users

```{r}
#function that takes basic scatterplot params as input and outputs the plot
create_scatter <- function(varname_x, varname_y, data, alpha){
  return(ggplot(aes_string(x = varname_x, y = varname_y), data = data) + 
                  geom_point(alpha = alpha))
}

create_scatter('num_voted_users', 'imdb_score', movies, 1/5)+
  scale_y_continuous(breaks = seq(0,10,.5))
```

After reducing overplotting by adjusting alpha param, we can see that low-rank 
movies tend to have the lowest numbers of user votes, however the movie rank 
increases with the number of votes.

We might think that the IMDb ranking of a particular movie is FORMED by the 
number of user votes for it but that is not so. 
[IMDb ranking system](https://en.wikipedia.org/wiki/IMDb#User_ratings_of_films) 
is based on weighted average, so the movies that have many users voted, but most
users rated a movie with 6 out 10, will have lower ranking than movies with less
users voted but most of users rated a movie with 10 out of 10.

#### IMDb score vs. Movie Total Reviews

```{r, warning=FALSE}
create_scatter('movie_total_reviews', 'imdb_score', movies, 1/10) +
  xlim(0,quantile(movies$movie_total_reviews,.95))
```

Again, we see that with the number of total reviews of the movie tend to 
increase the IMDb score increase too: low-rank movies (IMDb score <5) having 
up to 750 reviews and higher ranking movies - up to 1700.

However let's explore if total reviews and number of voted users relate to each
other 

```{r, warning=FALSE}

create_scatter('num_voted_users', 'movie_total_reviews', movies, 1/10) +
  xlim(0,quantile(movies$num_voted_users, .95)) + 
  ylim(0,quantile(movies$movie_total_reviews, .95)) 
```

We can notice considerable correlation between variables, which makes sense, 
since with more people voted for a certain movie, the likelihood that they would 
leave a review for the movie increase. However, the relationship seems quite 
obvious for the movies with low number of votes and low number of reviews, 
whereas for movies with higher number of votes the number of movie reviews is 
quite dispersed. 

#### IMDb score vs. Movie Facebook Likes

We are also interested to investigate the relationship between movie IMDb score
and movie facebook likes. 

```{r, warning=FALSE}

create_scatter('movie_facebook_likes', 'imdb_score', 
               subset(movies, movies$movie_facebook_likes>0), 1/5) +
  xlim(0,quantile(movies$movie_facebook_likes,.95)) + 
  scale_y_continuous(breaks = seq(0,10,.5)) 
```

Low-score movies tend to have very low number of facebook likes, but it 
increases for movies with IMDb score higher than 5.5, but having passed this
mark we loose the pattern : all movies with IMDb scores > 5.5 have equal chances
to get high number of facebook likes. 

#### IMDb score across genres

```{r}
create_histo('imdb_score', genres_df, 40)+
  scale_x_continuous(breaks = seq(1,10,1)) + 
  geom_vline(aes(xintercept = mean(imdb_score)), color = 'red', linetype = 2)+ 
  facet_wrap(~genres)
```

Plotting IMDb score by genres gives quite stable picture : mostly 
normal distribution for each genre, that peaks at overall mean. So we cannot say 
that some particular genres may have better ranking on IMDb than others.

Now let's see if we can reveal any relationship between movie duration and movie 
IMDb score

```{r}
create_scatter('duration', 'imdb_score', movies, 1/10) + 
  scale_x_continuous(breaks = seq(0,350,20))+
  scale_y_continuous(breaks = seq(0,10, .5))
```

As per our plot the biggest part of the movies are within 80 to 140 minutes: 
the duration of low-ranking movies is within 80-120 mins, while for the movies
with imdb_score above 5 the duration is much more disperced and falls in range
100 - 160. The general pattern is quite obvious with the increase of duration, 
movie IMDb score increases too. 

This also proved by the fact that all epic Oscar winners in recent decades were
at least 120 mins long : 'Titanic', 'Braveheart', 'Godfather'  back in 90s, 
'Slumdog Millionaire',  'The Lord of The Rings' in 00s and 'The King's Speech', 
'Argo' in 10s, 

Let's investigate the average movie duration over the years.
We expect to see the increase in mean movie duration in recent decades because 
of switch from analogue to digital film making (shooting 3 hours long movie on 
35 mm film is way more costly than on hard drive) so saving on production, 
directors can spend more money on elaborating the movie story line, which 
resulted in longer movie duration. 

To do that we create new data frame with our variables grouped by title years 
and summarized with mean and median values per each group. 

```{r, message=FALSE, warning=FALSE}
duration_by_year <- movies %>%
  group_by(title_year) %>%
  summarise(mean_duration = mean(duration), 
            median_duration = median(duration),
            n = n())

ggplot(aes(x = title_year, y = mean_duration), data = duration_by_year) +
  geom_line(color = 'red', linetype = 2) + 
  geom_line(aes(x=title_year, y = median_duration), data = duration_by_year,
            color = 'blue', linetype = 3) + 
  scale_x_continuous(breaks = seq(1925,2016,5)) + 
  geom_smooth()
```

Looks like our assumption is incorrect, because as per the plot the average
movie duration is actually decreased over time : since we have very few old 
movies (before 1960s), we see those substantial fluctuations on mean duration 
graph,  and with the number of movies for a given year increases, the graph gets 
smoother, however the general trend is still quite visible : mean duration is 
decrasing in late years. 

Let's check out budget and duration relationship 

```{r, warning=FALSE}

ggplot(aes(x = budget, y = duration), data = movies) + 
  geom_point(alpha = 1/10, position = position_jitter())+
  #scale_x_continuous(breaks = c(0,135000000), minor_breaks = 10000000)
  xlim(0,quantile(movies$budget,.95)) + 
  geom_hline(yintercept = mean(movies$duration), color = 'red', linetype = 2)
```

We can see curious vertical lines on the plot - this is probably because very
often movie budget is aproximated as 'good looking' number (10 million dollars, 
20 million dollars etc). Besides, we can see that there
is no evident relationship between budget and duration: in fact the longest 
duration movies tend to be low or medium budget. 

Now let's explore the relationships of IMDn score with financial variables
(gross, profit and ROI)

#### IMDb score vs. Gross

```{r, warning=FALSE}
create_scatter('gross_2016', 'imdb_score', movies, 1/5) +
  xlim(0,quantile(movies$profit, .95))
```

Let's summarise our plot and see the varaition of mean and median gross for each 
IMDb rank and add it as a layer to our previous plot, we also adjust alpha 
parameter to reduce overplotting. 

This will help us to see the general trend in gross figures as imdb score 
increases.

```{r, warning=FALSE, fig.height = 5, fig.width= 10}
gross_summary <- movies %>%
  group_by(imdb_score) %>%
  summarise(mean_gross = mean(gross_2016),
            n = n())

create_scatter('gross_2016', 'imdb_score', movies, 1/10) +
  xlim(0,quantile(movies$gross_2016, .95))+
  geom_line(aes(y = imdb_score, x = mean_gross), 
            data = gross_summary,linetype = 1, color = 'red', size=1) 
```

There are some occasional spikes in mean gross, however the general 
trend is still visible: with the mean gross increase, movie IMDb score
increases. 

#### IMDb score vs. Profit

```{r, warning=FALSE}
create_scatter('profit', 'imdb_score', movies, 1/5) +
  xlim(0,quantile(movies$profit, 0.95)) + 
  scale_y_continuous(breaks = seq(0,10,.5))
```

The profits of the low-ranking movies (imdb_score < 5) seem to be mainly below 
50 million dollars, whereas high-ranking movies profits are very diverse and 
could reach up to 250 million. 

However, there is a considerable part of movies that have good imdb score with 
very moderate profits (within 25 million dollars and below). In fact, the 
"Shawshank Redemption", which is IMDb highest rank movie ever earned only modest
5.5 million dollar profit!

Let's examine profit and IMDb score relationship across diffrent genres 

```{r, message=FALSE, warning=FALSE}
#first updating genres_df with new variables
genres_df <- left_join(genres_df, movies[,c('profit','title_year.bucket','roi',
                                            'movie_total_reviews','movie_title', 
                                            'director_name')], 
                       by = c('movie_title' = 'movie_title',
                              'director_name' = 'director_name')) 

create_scatter('profit', 'imdb_score', genres_df, 1/5)+
  xlim(0,quantile(genres_df$profit, 0.95)) + 
  geom_smooth()+
  facet_wrap(~genres)
```

Splitting profits by genres did not reveal any new patterns in our data.

However we also want to see how movie IMDb score changes with the increase
of mean and median profits so let's summarise our profit numbers for each IMDb 
score and add this information to our plot. 

```{r, message=FALSE, warning=FALSE, fig.height = 5, fig.width=10}
profit_summary <- movies %>%
  group_by(imdb_score) %>%
  summarise(mean_profit = mean(profit),
            n = n())

create_scatter('profit', 'imdb_score', movies, 1/10)+
  xlim(quantile(movies$profit, .05),quantile(movies$profit, .95))+
  geom_line(aes(y = imdb_score, x = mean_profit), 
            data = profit_summary,linetype = 1, color = 'orange', size=1) + 
  geom_vline(xintercept = 0, linetype = 2, color= 'red') 
```

Sure enough, average profits for low-ranking movies tend to be low , sometimes 
even negative, however movie ranking inceases with mean profits increase.  

Now we want to see if there is any relationship between profits and ROI 
ratio. Intuitively, we can assume that higher profits bring higher ROI.

```{r, warning=FALSE}
create_scatter('profit', 'roi', movies, 1)+
  xlim(0,quantile(movies$profit, .95))+
  ylim(0,quantile(movies$roi, .95))
```

Looks like there is hardly any visible relationship at all: there is a bunch of
highly profitable movies with low ROI percetage and there are a lot of movies
with both high profits and high ROI percentage. This is quite strange since 
profit is taken into account while calculating ROI ratio. 

Now we want to see if ROI percentage is connected with IMDb score

```{r, warning=FALSE}

create_scatter('roi','imdb_score', movies, 1/5)+
  xlim(0,quantile(movies$roi, .95)) + 
  scale_y_continuous(breaks = seq(0,10,.5))
```

In fact, ROI data points distributed across various IMDb scores very similarly 
to profit variable. 

Now we want to see ROI in dynamics across different IMDb scores, to achieve that
we apply the same technique as above: summarise ROI numbers for each imdb score
and plot them over imdb_score - roi scatterplot

```{r, warning=FALSE, fig.width = 10, fig.height= 5}
roi_summary <- movies %>%
  group_by(imdb_score) %>%
  summarise(mean_roi = mean(roi),
            n = n())
create_scatter('roi','imdb_score',movies, 1/10)+
  xlim(quantile(movies$roi, .05),quantile(movies$roi, .95))+
  geom_line(aes(y = imdb_score, x = mean_roi),
            data = roi_summary,linetype = 1, color = 'red', size=1) 
```

The summary graphs are very noisy but we still can  observe similar trend as 
above : low-ranking movies tend to have lower average ROI percentage as movie 
with higher IMDb ranking.

Lastly, we want to investigate if there is any relationship between IMDb score 
and movie genre. Do movies of certain genres score higher than others ?

#### IMDb score vs. Genre

```{r}
imdb_by_genre <- genres_df%>%
  group_by(genres) %>%
  summarise(mean_score = mean(imdb_score),
            medin_score = median(imdb_score))

ggplot(aes(x = genres, y= imdb_score), data = genres_df) + 
  geom_boxplot() + 
  theme(axis.text.x=element_text(angle=45,hjust=1)) + 
  scale_y_continuous(breaks = seq(0,10,.5)) 
```

The median IMDb score for almost all genres are within  6 - 7 range, 
however the median IMDb score for Film-Noir, and News genres rises considerably 
above the general trend and median IMDb score for Game Show and Reality TV
falls below the general trend. 

It is curious, that there are a lot of outliers below Q1 of the imdb-score
for each genre and very few outliers above Q3. This means, that
genre-wise the distribution of IMDb scores is skewed towards lower IMDb scores, 
we can also notice that IMDb low-ranking movies are present in almost all 
genres.

Let's zoom in the upper part of our boxplot to see which genres tend to have 
higher IMDb score than others. 

```{r, warning=FALSE}
ggplot(aes(x = genres, y= imdb_score), data = genres_df) + 
  geom_boxplot() + 
  theme(axis.text.x=element_text(angle=45,hjust=1)) + 
  ylim(8,10) 
```

The highest ranking have Crime movies, with Action, Dramas and Thrillers being 
close behind.

# Bivariate Analysis

### Talk about some of the relationships you observed in this part of the \
investigation. How did the feature(s) of interest vary with other features in \
the dataset?

As per our analysis, IMDb score is closely related to movie popularity 
parameters (high ranking movies tend to have higher number of votes and reviews 
from users) and profitability parameters (movies with higher IMDb score tend to 
have higher average profitability and ROI percentage), whereas the relationship 
between movie IMDb ranking and movie production characteristics (title year, 
duration, genre) seems to be quite weak.

### Did you observe any interesting relationships between the other features \
(not the main feature(s) of interest)?

The most interesting relationship was between mean movie duration and title year. 
With the switch from analogue to digital movie making the costs of movie 
production were reduced significantly (buying and handling lots of 35 mm film 
reels is way more costly than spend a couple hundreds of dollars for a  hard 
drive), so logically the directors had more budget to elaborate on the story 
line, therefore we expected longer movie duration in the period from 1990s till
2010s. However, having ploted the mean movie duration across years, we found 
that it actually decreased comparing to the earlier periods. 

### What was the strongest relationship you found?

We should admit that the data in this dataset is quite diverse: there are
relationships that are true for some movies but do not work for the others. 
For example, we found an interesting relationship between movie IMDb score and 
number of facebook likes: low-score movies tend to have very low number of 
facebook likes, but it increases drammatically for movies with IMDb score higher 
than 5.5, but having passed this mark we loose the pattern : all movies with 
IMDb scores from 5.5 and up have equal chances to get high number of facebook
likes. 

However, the strongest general trends that are true all data are relationship 
between financial characteristics : we noticed positive correlation between mean
gross and IMDb score and betwee mean profit/ROI and IMDb score. 

There is also a strong posistive correlation between movie IMDb score increases 
and the number of voted users. 

# Multivariate Plots Section

In this section we want to investigate deeper the relationships we found in 
bivariate analisys. 

Firstly let's look at movies budgets.

#### IMDb score vs. Budget vs. Genres

```{r, warning=FALSE}
#expanding the color pallete for 22 variables
colorCount = length(unique(genres_df$genres))
getPalette = colorRampPalette(brewer.pal(9,'Set1'))


ggplot(aes(y = imdb_score, x = budget_2016, color = genres),data = genres_df)+ 
  geom_point(position = position_jitter(h=0)) + 
  scale_color_manual(values = getPalette(colorCount)) + 
  xlim(0,quantile(genres_df$budget_2016, 0.95)) + 
  scale_y_continuous(breaks = seq(0,10,.5)) 
```

At first glance this looks like a dead end : there is no visible trend in IMDb 
score vs. profit for any particular genre.

This goes against our intuition since movies budget DOES influence the quality 
of the movie (the high budget allows better graphics, cast, soundtrack which
increase the movie quality and consequently should increase it's IMDb score - I 
would more often prefer high budget movie over low budget), so
let's look at this data from another angle: we facet our general scatter plot 
by genre. 

```{r, message=FALSE, warning=FALSE, fig.height =6, fig.width= 10}
#summarise our data first
budget_by_score_by_genre <- genres_df %>%
  group_by(genres, imdb_score) %>%
  summarise(mean_budget_by_score_by_genre = mean(budget_2016))

ggplot(aes(y = imdb_score, x = mean_budget_by_score_by_genre,color = genres),
       data = budget_by_score_by_genre) + 
  geom_line()+
  geom_vline(xintercept = mean(genres_df$budget_2016), linetype = 2) + 
  scale_x_continuous(breaks = seq(0,250000000, 100000000), labels = comma) +
  scale_color_manual(values = getPalette(colorCount)) + geom_smooth() + 
  theme(axis.text.x=element_text(angle=45,hjust=1)) + 
  facet_wrap(~genres, ncol = 7) 
```

Facetting gives much more clarity and we see that all movie genres could be 
divided in two big groups: the first group where IMDb score is not 
changing with mean budget increase, it also often falls below the average budget 
across all movies (Romance, Sport, Mystery, Documentary, Horror), the second 
group where the average budget increase with the increase of IMDb score (Action,
Adveture, Sci-Fi, Family, Animation).

So just as we anticipated budget does effect movie IMDb score, but only in
genres where the budget increase will influence the quality of the movie 
(e.g.increasing budget for SciFi movie allows better graphics that contributes
to movie quality: people won't appreciate a SciFi movie with cheap graphics; at
the same time this won't work for Documentary or Romance since the increase in 
budget won't contribute to movie quality that much).

Let's continue our genre wise investigation and explore the relationship
between mean duration and IMDb score of the movies genre wise.

```{r, message=FALSE, warning=FALSE}
duration_by_genre <- genres_df %>%
  group_by(genres, imdb_score) %>%
  summarise(mean_duration = mean(duration))

ggplot(aes(x = mean_duration, y = imdb_score), data=duration_by_genre) + 
  geom_line() + 
  geom_smooth(color = 'red', size =.5) + 
  facet_wrap(~genres)
```

There we see a clear pattern across all genres : IMDb score increase with movie 
duration increase.

Based on what we've investigated so far we see that though the general trend was 
not visible in bivariate analysis, dissecting it genre wise really helped us to 
reveal the trend. 

#### IMDb score vs. profit vs. budget

```{r, warning=FALSE}
ggplot(aes(y = imdb_score, x = profit, size = budget_2016), data = movies) + 
  geom_point(shape = 21, color = '#000000', fill = 'dodgerblue') +
  xlim(0,quantile(movies$profit, 0.95)) + 
  scale_y_continuous(breaks = seq(0,10,.5))
```

Here the pattern is not visible as well, some movies have high budget but low 
profit and low IMDb score and there are also low-budget movies that earned high
IMDb score and made good profit. However, we should admit that the higher 
ranking a movie has, the more chance it may return high profit. 

#### IMDb score vs. budget vs. number of voted users 

```{r, warning=FALSE}
ggplot(aes(y = imdb_score, x = budget_2016, size = num_voted_users), 
       data = movies) + 
  geom_point(shape = 21, color = '#000000', fill = 'yellow') +
  xlim(0,quantile(movies$budget_2016, 0.95)) + 
  scale_y_continuous(breaks = seq(0,10,.5))  
```

This plot comfirms that high budget does not guarantee movie popularity and 
high IMDb score, as we can see that only high score movies receive more number
of votes regardless of their budget. 

Again, we must keep in mind that IMDb score is not formed by the number of votes
because it is based on weighted mean not arithmetic mean (so the movie with 
fewer votes but high scores (e.g. total 10 votes with score 9) will have higher 
IMDb rank then movie with more votes but lower scores(e.g. totel 100 votes with 
score 7)) so the pattern confirms that people tend to be willing to vote for the
movies with higher IMDb scores which are not necesserily blockbusters.

#### IMDb score vs. number of voted users vs. number of movie reviews 

```{r echo=FALSE, Multivariate_Plots, fig.width=10, fig.height=5}
ggplot(aes(y = imdb_score, x = num_voted_users, size = movie_total_reviews), 
       data = movies) + 
  geom_point(alpha = 1/5,shape = 21, colour = "#000000", fill = "maroon")+
  scale_size_continuous(range=c(1,10))
```

The number of movie reviews is increasing together with the number of votes from 
users and IMDb score. 

#### IMDb score vs. number of voted users vs. title_year.bucket

```{r}
ggplot(aes(x = num_voted_users, y = imdb_score), data=movies) + 
  geom_point() +
  theme(axis.text.x=element_text(angle=45,hjust=1), 
        plot.title = element_text(hjust = 0.5)) + 
  facet_wrap(~title_year.bucket)
```

Here we also see very interesting pattern: IMDb users tend to vote more for the
recent movies (released in 1990s - 2010s) regardless of their IMDb score and 
old movies, while having quite high IMDb score tend to receive less user votes:
we notice mostly pink and purple dots representing recent movies on the upper 
part of the plot and blue, green and orange dots representing older movies at 
the bottom. 

# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the \
investigation. Were there features that strengthened each other in terms of \
looking at your feature(s) of interest?

We investigated two types of movies characteristics from different angles and 
in combination with each other to determine if they effect movies IMDb scores. 

There are few interesting relationships :

- people tend to be willing to vote for the movies with higher IMDb scores which
are not necesserily blockbuster i.e high budget does not guarantee popularity to
the movie.

- users tend to vote more for the recent movies (released in 1990s - 2010s) 
regardless of their IMDb score and old movies, while having quite high IMDb 
score tend to receive less user votes;

- movie reviews and number of votes from users are increasing in tandem together
and make IMDb score increase too. 

### Were there any interesting or surprising interactions between features?

One of the big surprises was that at first glace we did not see any relationship 
between movie IMDb score, genre and budget. This looked a bit weird to me, 
because I would favour high budget movie over low budget mainly because more 
budget allows better graphics, soundtrack, famous actors and so on). I think 
this is quite usual behavior among movie-lovers so I was confused why my plots 
do not reflect it. 

I decided to analyse IMDb score and budget for each genre separately and 
discovered that the trend that I was expecting to see is there but not for all 
genres: those genres that are budget-prone (i.e. where the budget can improve
the quality of a movie e.g.for movies involving a lot of graphics higher budget
will allow better graphics and therefore the overall movie quality will become 
better, genres like SciFi, Action, Adventure etc.) IMDb score increases with 
increasing the budget. However in genres that are not very budget-prone 
(Romance, Documentary) this trend is not present.

Likewise,I analysed IMDb score and movie duration relationship across genres and
discovered the patern that was not visible in bivariate analysis : with 
movie duration incraese, movie IMDb score increases as well.

------

# Final Plots and Summary

### Plot One

```{r echo=FALSE, Plot_One}
ggplot(aes(x = imdb_score), data = movies) + 
  geom_histogram(bins = 40, color = 'black', fill = 'blue') + 
  scale_x_continuous(breaks = seq(1,10,.5)) + 
  scale_y_continuous(breaks = seq(0,320,25)) +
  geom_vline(aes(xintercept = mean(imdb_score), color = 'Mean'), 
             linetype = 2)+ 
  geom_vline(aes(xintercept = median(imdb_score),color = 'Median'),
             linetype = 2)+
  labs(x = 'Movies IMDb score', y = 'Number of movies') +
  ggtitle('Distribution of movies IMDb scores') + 
  theme(plot.title = element_text(hjust = 0.5))+
  scale_colour_manual(values = c("red","yellow"), name = " ")
```

### Description One

The distribution of movies IMDb scores is slightly skewed to the left but 
otherwise looks normal, peaking at 6.5 - 7.0 with minimum value at 1.5 and
maximum value at 9.3, the mean and median of the distribution being very close
(about .13 standard deviation apart) 


### Plot Two

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(y = imdb_score, x = num_voted_users), data = movies) + 
  geom_point(alpha = 1/5, position = position_jitter(h = 0)) + 
  scale_y_continuous(breaks = seq(0,10,.5)) +
  geom_smooth(color = 'red') +
  labs(y = 'Movies IMDb score', x = 'Number user votes on IMDb website') +
  ggtitle('Movie IMDb Score vs Number of User Votes Relationship') + 
  theme(plot.title = element_text(hjust = 0.5))
```

### Description Two

One of the strongest factors that influence movie IMDb score is number of user 
votes on IMDb website, however the relationship is not linear since IMDb ranking
syster is based on weighted average, where scores have different weight (i.e. 
movie with 10 votes all scoring movie with 9 has higher IMDb score than movie 
with 100 votes scoring movie with 6).

### Plot Three

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.height= 6, fig.width= 10}
ggplot(aes(y = imdb_score, x = mean_budget_by_score_by_genre, color = genres), 
       data = budget_by_score_by_genre) + 
  geom_line()+
  scale_x_continuous(breaks = seq(0,250000000, 100000000), labels = comma) +
  scale_y_continuous(breaks = seq(0,10,2)) +
  scale_color_manual(values = getPalette(colorCount)) + geom_smooth() + 
  labs(y = 'Movies IMDb score', x = 'Mean Budget, USD') +
  ggtitle('Movies IMDb score and Mean Budget Relationship Across Genres' ) +
  theme(axis.text.x=element_text(angle=45,hjust=1), 
        plot.title = element_text(hjust = 0.5)) + 
  facet_wrap(~genres, ncol = 7) 
```

### Description Three

Though budget and IMDb score relationship is not clear while analysing 
budgets and score for all movies it becomes clear when analysed for 
each genre separately. 

Those genres that are budget-prone (i.e. where the budget can improve the 
quality of a movie e.g.for movies involving a lot of graphics higher budget will
allow better graphics and therefore the overall movie quality will become 
better, genres like SciFi, Action, Adventure etc.) IMDb score increases with 
increasing the budget. However in genres that are not very budget-prone 
(Romance, Documentary) this trend is not present.

------

# Reflection

The original movies dataset contains information about 5043 movies across 
28 variables.

Since the dataset was scraped from the IMDb website, the raw data had to be 
cleaned before starting the analysis. After removing duplicate rows and NAs and 
creating some new variables, the final dataset had 3655 observations across 38 
variables. 

At the data cleaning phase we also had to tidy movie budget and gross variables
because :

1. For some movies released outside the US, movie budget was expressed in local
currency, so we had to modify data collection source code in 
order to be able to see the budget currency for each movie (originally,
this information was dropped while parsing data scraped from IMDb website). Then
we had to convert all the currencies to USD and to do that we scraped the 
exchange rates for the period 1953 - 2016 for all our currencies.

2. To be able to analyse and compare budget and gross for movies released in 
different years, we had to account for inflation and standardize these variables
to a single base (we chose 2016), to achieve that, we had to scrape the US 
Consumer Price Index for the period from 1900 - 2016 and adjust our budget and 
gross variables. 

The next challenge during data wrangling phase was genres variable:it contained 
several values for each row, so in order to perform the genre wise analysis we 
had to create new dataframe and 'unwind' genres for each movie.

Following the data correlation matrix and our intuition we selected 9 variables
that might influence movies IMDb score, they could be divided in three groups:
movie production characteristics (title year, duration, genre), popularity 
characteristics (number of voted users, number of user reviews, movie facebook 
likes) and financial chracteristics (budget and gross).

The most evident factors that influence IMDb score are movie popularity 
characteristics(number of voted users and number of voted reviews) while others 
require more analysis to reveal the pattern: the relationship between movie 
financial characteristics (profit and ROI) is not visible untill you summarize 
them into mean and median values, only the plot becomes visible: high-score 
movies tend to have higher average profits and ROIs. 

I think that the biggest success of this analysis is revealing the 
underlying relationship between movies budget and IMDb score: intuitively the
positive correlation between these variables make sense but the actual 
correlation coefficient and bivariate analysis were not reflecting it. 

The trend was uncovered while perfoming IMDb score vs movie budget analysis for 
each of movie genres separately: for those genres that are budget-prone (i.e. 
where the budget can improve the quality of a movie e.g.for movies involving a 
lot of graphics higher budget will allow better graphics and therefore the 
overall movie quality will become better, genres like SciFi, Action, Adventure 
etc) the budget increase is contributing to movie IMDb score, while for those 
movies that are less budget-prone (Romance, Documentary) this relationship is 
disapearing. 

For future it will be very exciting to use all our findings to build a model and
predict movie IMDb score. 
Since the data is quite diverse and there are no linear relationships between 
variables, the linear model is likely to show low results, so possibly we would
need to resort to more complicated algorithms.  
